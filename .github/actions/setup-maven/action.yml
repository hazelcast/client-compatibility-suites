name: Setup Maven
runs:
  using: "composite"
  steps:
    - name: Read Java Config
      shell: bash 
      run: cat ${GITHUB_WORKSPACE}/.github/java-config.env >> $GITHUB_ENV

    - name: Setup Java
      uses: actions/setup-java@v4
      with:
        java-version: ${{ env.JAVA_VERSION }}
        distribution: ${{ env.JAVA_DISTRIBUTION }}

      # Based off https://github.com/actions/cache/blob/master/examples.md#java---maven
      # Uses seperate cache action to avoid SNAPSHOTs
    - id: maven-cache
      uses: actions/cache@v4
      with:
        path: |
          ~/.m2/repository/repository
          !**/*SNAPSHOT*/
        key: ${{ runner.os }}-maven-${{ hashFiles('**/pom.xml') }}
